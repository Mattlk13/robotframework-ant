<?xml version="1.0"?>

<project name="RobotAnt" default="alljar" basedir=".">

	<description>
        build file for RobotFramework Ant task
    </description>
	<!-- get version property -->
	<property file="conf.properties"/>
	<!-- set global properties for this build -->
	<property name="src" location="src"/>
	<property name="build" location="build"/>
	<property name="dist"  location="dist"/>
	<property name="jarfile"  value="ant-robotframework-${version}.jar"/>

	<target name="init">
		<!-- Create the time stamp -->
		<tstamp/>
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${build}"/>
		<!-- Create the distribution directory -->
		<mkdir dir="${dist}"/>
	</target>

	<target name="build" depends="init">
		<javac srcdir="src" destdir="build"
            source="1.5"
            target="1.5"
        	debug="on"
            includeAntRuntime="false"
            classpath="lib/ant.jar"
        />
	</target>

	<target name="createjar" depends="build"
        description="generate the jar distribution" >
		<delete file="${dist}/${jarfile}"/>

		<jar jarfile="${dist}/${jarfile}"
       basedir="."
       includes="robotant.properties">

			<fileset dir="${build}"/>
			<fileset dir="${src}"/>

			<manifest>
				<!-- Who is building this jar? -->
				<attribute name="Built-By" value="Laurent Carbonnaux"/>
				<!-- Information about the program itself -->
				<attribute name="Implementation-Vendor" value="ScrumVision.org"/>
				<attribute name="Implementation-Title" value="RobotframeworkAnt"/>
				<attribute name="Implementation-Version" value="${version}"/>
			</manifest>

		</jar>
	</target>


	<target name="declare" depends="createjar">
		<taskdef name="robotant"
        classname="org.lcx.robotframework.ant.RobotAnt"
        classpath="${dist}/${jarfile}"/>
	</target>

	<target name="cplxjar" depends="declare">
		<robotant 
        jar="libext/robotframework-selenium-2.5.4.1.jar"
        data_sources="rftest/TestSelenium.html"
		name="TestExecution Result"
        loglevel="TRACE"
        debugfile="jybot.log"
        outputdir="resultats"
    	suite="TestSelenium"
    	test="'Test search on google'"
		variablefile="path/vars.py"
        >
			<arg line="--version"/>
            <arg line="--variable str:Hello"/>
		</robotant>
	</target>

	<target name="simpleclass" depends="declare">
		<robotant fork="false">
			<arg line="--loglevel TRACE"/>
			<arg line="TestSelenium.html"/>
			<classpath>
				<pathelement location="libext/selenium-server.jar"/>
			</classpath>
		</robotant>
	</target>

	<target name="jarbootclass" depends="declare">
		<robotant fork="true">
			<arg line="--loglevel TRACE"/>
			<arg line="rftest/TestSelenium.html"/>
			<bootclasspath>
				<pathelement location="libext/selenium-server.jar"/>
			</bootclasspath>
		</robotant>
	</target>

	<target name="simplejar" depends="declare">
		<robotant>
			<arg line="--loglevel TRACE"/>
			<arg line="rftest/TestSelenium.html"/>
			<bootclasspath>
				<pathelement location="libext/selenium-server.jar"/>
			</bootclasspath>
		</robotant>
	</target>

    <target name="simplejarargfile" depends="declare">
        <robotant data_sources="rftest/TestSelenium.html">
            <argumentfile file="rftest/first.txt"/>
            <argumentfile file="rftest/second.txt"/>
            <bootclasspath>
                <pathelement location="libext/selenium-server.jar"/>
            </bootclasspath>
        </robotant>
    </target>

    <target name="datasource" depends="declare">
        <robotant data_sources="rftest/TestSelenium.html" jar="libext/robotframework-selenium-2.5.4.1.jar">
            <data_source file="first.txt"/>
            <data_source file="second.txt"/>
        	<arg line="--help"/>
            <classpath>
                <pathelement location="libext/selenium-server.jar"/>
            </classpath>
        </robotant>
    </target>

	<target name="alljar" depends="simplejar, cplxjar, jarbootclass, simplejarargfile, datasource"/>
	<target name="all" depends="alljar, simpleclass"/>

	<target name="javaclass" depends="declare">
		<java classname="org.robotframework.RobotFramework">
			<arg line="--loglevel TRACE"/>
			<arg value="rftest/TestSelenium.html"/>
			<classpath>
				<pathelement location="libext/robotframework-selenium-2.5.4.1.jar"/>
			</classpath>
		</java>
	</target>

	<target name="javajar" depends="declare">
		<java jar="libext/robotframework-selenium-2.5.4.1.jar" fork="true">
			<arg line="--loglevel TRACE"/>
			<arg value="rftest/TestSelenium.html"/>
		</java>
	</target>

</project>

